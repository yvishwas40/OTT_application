(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[919],{7227:function(e,t,s){Promise.resolve().then(s.bind(s,8282))},1883:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(4313).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5555:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(4313).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},7686:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(4313).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},8915:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});let l=(0,s(4313).Z)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]])},7734:function(e,t,s){"use strict";s.d(t,{n:function(){return i}});var l=s(7573),a=s(8146),r=s(4629),n=s(5330),o=s(8915);function i(){let{user:e,logout:t}=(0,r.a)();return(0,l.jsx)("header",{className:"sticky top-0 z-50 w-full bg-slate-900/95 backdrop-blur-sm border-b border-slate-800",children:(0,l.jsx)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,l.jsx)(a.default,{href:"/",className:"flex items-center",children:(0,l.jsx)("h1",{className:"text-2xl font-bold text-yellow-500",children:"Chai Shorts"})}),(0,l.jsx)("div",{className:"flex items-center gap-4",children:e?(0,l.jsxs)(l.Fragment,{children:["ADMIN"===e.role||"EDITOR"===e.role?(0,l.jsxs)(a.default,{href:"/cms",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-300 hover:text-yellow-400 transition-colors",children:[(0,l.jsx)(n.Z,{className:"h-4 w-4"}),"CMS"]}):null,(0,l.jsx)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-300 hover:text-yellow-400 transition-colors",children:"Logout"})]}):(0,l.jsxs)(a.default,{href:"/login",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-yellow-500 hover:text-yellow-400 transition-colors border border-yellow-500/50 rounded-lg hover:bg-yellow-500/10",children:[(0,l.jsx)(o.Z,{className:"h-4 w-4"}),"Login"]})})]})})})}},8282:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var l=s(7573),a=s(7653),r=s(1695),n=s(8146),o=s(7734),i=s(2226),c=s(1883),u=s(5555),d=s(7686),m=s(4313);let h=(0,m.Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);var x=s(4078);let g=(0,m.Z)("Captions",[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]]);function p(){var e,t,s,m,p,f;let v=(0,r.useParams)();(0,r.useRouter)();let y=v.id,[j,b]=(0,a.useState)(null),[N,w]=(0,a.useState)(!0),[k,S]=(0,a.useState)(""),[L,Z]=(0,a.useState)(""),[C,I]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=async()=>{var e,t;try{let t=(await i.h.get("/catalog/lessons/".concat(y))).data;b(t),t.contentLanguagePrimary?S(t.contentLanguagePrimary):(null===(e=t.contentLanguagesAvailable)||void 0===e?void 0:e.length)>0&&S(t.contentLanguagesAvailable[0])}catch(e){(null===(t=e.response)||void 0===t?void 0:t.status)===404?I("Episode not found or not published"):I("Failed to load episode"),console.error("Failed to fetch episode:",e)}finally{w(!1)}};y&&e()},[y]);let A=()=>{var e;return j&&L&&(null===(e=j.subtitleUrlsByLanguage)||void 0===e?void 0:e[L])||""};if(N)return(0,l.jsxs)("div",{className:"min-h-screen bg-slate-950",children:[(0,l.jsx)(o.n,{}),(0,l.jsx)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,l.jsxs)("div",{className:"animate-pulse",children:[(0,l.jsx)("div",{className:"h-96 bg-slate-800 rounded-lg mb-6"}),(0,l.jsx)("div",{className:"h-8 bg-slate-800 rounded w-1/2 mb-4"})]})})]});if(!j||C)return(0,l.jsxs)("div",{className:"min-h-screen bg-slate-950",children:[(0,l.jsx)(o.n,{}),(0,l.jsxs)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:C||"Episode not found"}),(null==j?void 0:null===(m=j.term)||void 0===m?void 0:m.program)&&(0,l.jsx)(n.default,{href:"/series/".concat(j.term.program.id),className:"text-yellow-500 hover:text-yellow-400",children:"Back to Series"})]})]});let M=j&&k&&(null===(p=j.contentUrlsByLanguage)||void 0===p?void 0:p[k])||"";return(0,l.jsxs)("div",{className:"min-h-screen bg-slate-950",children:[(0,l.jsx)(o.n,{}),(0,l.jsxs)("main",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(null===(e=j.term)||void 0===e?void 0:e.program)&&(0,l.jsxs)(n.default,{href:"/series/".concat(j.term.program.id),className:"inline-flex items-center gap-2 text-gray-400 hover:text-yellow-400 mb-6 transition-colors",children:[(0,l.jsx)(c.Z,{className:"h-4 w-4"}),"Back to ",j.term.program.title]}),(0,l.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("h1",{className:"text-3xl font-bold text-white mb-2",children:["Episode ",j.lessonNumber,": ",j.title]}),(0,l.jsxs)("div",{className:"flex items-center gap-4 text-gray-400",children:[(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsx)(u.Z,{className:"h-4 w-4"}),(f=j.durationMs,"".concat(Math.floor(f/6e4),":").concat(Math.floor(f%6e4/1e3).toString().padStart(2,"0")))]}),j.isPaid&&(0,l.jsxs)("span",{className:"flex items-center gap-2 text-yellow-500",children:[(0,l.jsx)(d.Z,{className:"h-4 w-4"}),"Premium Episode"]})]})]}),(0,l.jsx)("div",{className:"bg-slate-900 rounded-lg overflow-hidden mb-6",children:(0,l.jsx)("div",{className:"aspect-video bg-black relative",children:M?(0,l.jsxs)("video",{controls:!0,className:"w-full h-full",crossOrigin:"anonymous",children:[(0,l.jsx)("source",{src:M,type:"video/mp4"}),L&&A()&&(0,l.jsx)("track",{kind:"subtitles",srcLang:L,src:A(),default:!0}),"Your browser does not support the video tag."]},M):(0,l.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(h,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),(0,l.jsx)("p",{children:"Video URL not available"})]})})})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(null===(t=j.contentLanguagesAvailable)||void 0===t?void 0:t.length)>1&&(0,l.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[(0,l.jsx)(x.Z,{className:"h-4 w-4 inline mr-2"}),"Language"]}),(0,l.jsx)("select",{value:k,onChange:e=>S(e.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500",children:j.contentLanguagesAvailable.map(e=>(0,l.jsx)("option",{value:e,children:e.toUpperCase()},e))})]}),(null===(s=j.subtitleLanguages)||void 0===s?void 0:s.length)>0&&(0,l.jsxs)("div",{className:"bg-slate-900 rounded-lg p-4",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[(0,l.jsx)(g,{className:"h-4 w-4 inline mr-2"}),"Subtitles"]}),(0,l.jsxs)("select",{value:L,onChange:e=>Z(e.target.value),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500",children:[(0,l.jsx)("option",{value:"",children:"None"}),j.subtitleLanguages.map(e=>(0,l.jsx)("option",{value:e,children:e.toUpperCase()},e))]})]})]})]})]})]})}},2226:function(e,t,s){"use strict";s.d(t,{h:function(){return l}});let l=s(3908).Z.create({baseURL:"http://localhost:3000/api",headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)})},4629:function(e,t,s){"use strict";s.d(t,{AuthProvider:function(){return o},a:function(){return i}});var l=s(7573),a=s(7653),r=s(2226);let n=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[s,o]=(0,a.useState)(null),[i,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&t)try{let s=JSON.parse(t);o(s),r.h.defaults.headers.common.Authorization="Bearer ".concat(e)}catch(e){localStorage.removeItem("token"),localStorage.removeItem("user")}c(!1)},[]);let u=async(e,t)=>{try{let{access_token:s,user:l}=(await r.h.post("/auth/login",{email:e,password:t})).data;return localStorage.setItem("token",s),localStorage.setItem("user",JSON.stringify(l)),r.h.defaults.headers.common.Authorization="Bearer ".concat(s),o(l),!0}catch(e){return console.error("Login failed:",e),!1}};return(0,l.jsx)(n.Provider,{value:{user:s,login:u,logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),delete r.h.defaults.headers.common.Authorization,o(null)},loading:i},children:t})}function i(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},function(e){e.O(0,[908,280,293,427,744],function(){return e(e.s=7227)}),_N_E=e.O()}]);