(()=>{var e={};e.id=637,e.ids=[637],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},5240:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},1571:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>o,routeModule:()=>p,tree:()=>d}),t(2811),t(2612),t(7824);var a=t(3282),l=t(5736),r=t(3906),i=t.n(r),n=t(6880),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["cms",{children:["lessons",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,2811)),"C:\\Users\\yvish\\projects\\OTT platform\\OTT_app-main\\packages\\cms\\app\\cms\\lessons\\new\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,2612)),"C:\\Users\\yvish\\projects\\OTT platform\\OTT_app-main\\packages\\cms\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,7824,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\yvish\\projects\\OTT platform\\OTT_app-main\\packages\\cms\\app\\cms\\lessons\\new\\page.tsx"],u="/cms/lessons/new/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/cms/lessons/new/page",pathname:"/cms/lessons/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4668:(e,s,t)=>{Promise.resolve().then(t.bind(t,1646))},1646:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var a=t(3227),l=t(3677),r=t(1043),i=t(649),n=t(6483),c=t(8808),d=t(4651),o=t(7587),u=t(5169);function m(){let e=(0,r.useRouter)(),[s,t]=(0,l.useState)(!1),[m,p]=(0,l.useState)(""),[x,g]=(0,l.useState)([]),[h,b]=(0,l.useState)([]),[j,y]=(0,l.useState)(!0),[v,N]=(0,l.useState)(!1),[f,P]=(0,l.useState)({termId:"",lessonNumber:"",title:"",contentType:"VIDEO",durationMs:"",isPaid:!1,contentLanguagePrimary:"en",contentLanguagesAvailable:["en"],contentUrl:"",thumbnailUrl:"",portraitThumbnailUrl:"",subtitleUrl:"",shouldPublish:!0}),L=async e=>{if(e){N(!0);try{let s=await c.h.get("/terms",{params:{programId:e}});b(s.data)}catch(e){console.error("Failed to fetch terms:",e)}finally{N(!1)}}},T=e=>{e?L(e):b([]),P({...f,termId:""})},w=async s=>{s.preventDefault(),p(""),t(!0);try{if(!f.termId){p("Please select a season"),t(!1);return}if(!f.title.trim()){p("Title is required"),t(!1);return}if(!f.lessonNumber||1>parseInt(f.lessonNumber)){p("Episode number must be at least 1"),t(!1);return}if(!f.contentLanguagePrimary){p("Primary language is required"),t(!1);return}let s=f.contentLanguagesAvailable.includes(f.contentLanguagePrimary)?f.contentLanguagesAvailable:[...f.contentLanguagesAvailable,f.contentLanguagePrimary],a=await c.h.post("/lessons",{termId:f.termId,lessonNumber:parseInt(f.lessonNumber),title:f.title.trim(),contentType:f.contentType,durationMs:f.durationMs?6e4*parseInt(f.durationMs):null,isPaid:f.isPaid,contentLanguagePrimary:f.contentLanguagePrimary,contentLanguagesAvailable:s,contentUrlsByLanguage:{[f.contentLanguagePrimary]:f.contentUrl},subtitleLanguages:f.subtitleUrl?[f.contentLanguagePrimary]:[],subtitleUrlsByLanguage:f.subtitleUrl?{[f.contentLanguagePrimary]:f.subtitleUrl}:{},status:f.shouldPublish?"PUBLISHED":"DRAFT",publishedAt:f.shouldPublish?new Date().toISOString():null});if(f.thumbnailUrl)try{await c.h.post("/assets/lessons",{lessonId:a.data.id,language:f.contentLanguagePrimary,variant:"LANDSCAPE",assetType:"thumbnail",url:f.thumbnailUrl})}catch(e){console.error("Failed to add landscape thumbnail",e)}if(f.portraitThumbnailUrl)try{await c.h.post("/assets/lessons",{lessonId:a.data.id,language:f.contentLanguagePrimary,variant:"PORTRAIT",assetType:"thumbnail",url:f.portraitThumbnailUrl})}catch(e){console.error("Failed to add portrait thumbnail",e)}e.push(`/cms/lessons/${a.data.id}`)}catch(e){console.error("Failed to create episode:",e),p(e.response?.data?.message||"Failed to create episode. Please try again."),t(!1)}},U=e=>{if(f.contentLanguagesAvailable.includes(e)){if(e===f.contentLanguagePrimary){p("Cannot remove primary language from available languages");return}P({...f,contentLanguagesAvailable:f.contentLanguagesAvailable.filter(s=>s!==e)})}else P({...f,contentLanguagesAvailable:[...f.contentLanguagesAvailable,e]});p("")},q=x.find(e=>{let s=h.length>0?h[0]?.programId:null;return!!s&&e.id===s});return a.jsx(n.o,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx(i.default,{href:"/cms/lessons",className:"p-2 hover:bg-slate-800 rounded transition-colors text-gray-400 hover:text-white",children:a.jsx(d.Z,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-2xl font-bold text-white",children:"Create New Episode"}),a.jsx("p",{className:"text-gray-400",children:"Add a new episode to a series"})]})]}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"card p-6",children:[a.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Episode Information"}),m&&a.jsx("div",{className:"mb-4 p-4 bg-red-900/30 border border-red-900/50 rounded-lg text-red-400 text-sm",children:m}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Series ",a.jsx("span",{className:"text-red-400",children:"*"})]}),(0,a.jsxs)("select",{value:q?.id||"",onChange:e=>T(e.target.value),className:"input-field",required:!0,disabled:s||j,children:[a.jsx("option",{value:"",children:"Select a series"}),x.map(e=>a.jsx("option",{value:e.id,children:e.title},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Season ",a.jsx("span",{className:"text-red-400",children:"*"})]}),(0,a.jsxs)("select",{value:f.termId,onChange:e=>{P({...f,termId:e.target.value}),p("")},className:"input-field",required:!0,disabled:s||v||!q,children:[a.jsx("option",{value:"",children:"Select a season"}),h.map(e=>(0,a.jsxs)("option",{value:e.id,children:["Season ",e.termNumber," ",e.title?`- ${e.title}`:""]},e.id))]}),q&&0===h.length&&!v&&a.jsx("p",{className:"text-xs text-yellow-400 mt-1",children:"No seasons found. Create a season first in the series detail page."})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Episode Number ",a.jsx("span",{className:"text-red-400",children:"*"})]}),a.jsx("input",{type:"number",min:"1",value:f.lessonNumber,onChange:e=>{P({...f,lessonNumber:e.target.value}),p("")},className:"input-field",placeholder:"1",required:!0,disabled:s}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Episode number in this season"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Content Type ",a.jsx("span",{className:"text-red-400",children:"*"})]}),(0,a.jsxs)("select",{value:f.contentType,onChange:e=>P({...f,contentType:e.target.value}),className:"input-field",required:!0,disabled:s,children:[a.jsx("option",{value:"VIDEO",children:"Video"}),a.jsx("option",{value:"TEXT",children:"Text"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Episode Title ",a.jsx("span",{className:"text-red-400",children:"*"})]}),a.jsx("input",{type:"text",value:f.title,onChange:e=>{P({...f,title:e.target.value}),p("")},className:"input-field",placeholder:"Enter episode title",required:!0,disabled:s})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Duration (minutes)"}),a.jsx("input",{type:"number",min:"0",step:"0.1",value:f.durationMs,onChange:e=>P({...f,durationMs:e.target.value}),className:"input-field",placeholder:"2",disabled:s}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Duration in minutes (e.g., 2 for 2 minutes)"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Access Type"}),(0,a.jsxs)("label",{className:"flex items-center mt-2",children:[a.jsx("input",{type:"checkbox",checked:f.isPaid,onChange:e=>P({...f,isPaid:e.target.checked}),className:"mr-2 rounded border-gray-600 bg-slate-800 text-yellow-500 focus:ring-yellow-500",disabled:s}),a.jsx("span",{className:"text-sm text-gray-300",children:"Premium Episode (Requires Subscription)"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Content URL (Video/HLS) - ",f.contentLanguagePrimary," ",a.jsx("span",{className:"text-red-400",children:"*"})]}),a.jsx("input",{type:"url",value:f.contentUrl,onChange:e=>P({...f,contentUrl:e.target.value}),className:"input-field",placeholder:"https://example.com/video.mp4",required:!0,disabled:s})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Landscape Thumbnail URL"}),a.jsx("input",{type:"url",value:f.thumbnailUrl,onChange:e=>P({...f,thumbnailUrl:e.target.value}),className:"input-field",placeholder:"https://example.com/thumb_landscape.jpg",disabled:s}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"16:9 ratio (e.g., 1920x1080)"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Portrait Thumbnail URL"}),a.jsx("input",{type:"url",value:f.portraitThumbnailUrl,onChange:e=>P({...f,portraitThumbnailUrl:e.target.value}),className:"input-field",placeholder:"https://example.com/thumb_portrait.jpg",disabled:s}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"2:3 ratio (e.g., 1000x1500)"})]})]}),a.jsx("div",{className:"space-y-4 pt-2",children:(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Subtitle URL (VTT)"}),a.jsx("input",{type:"url",value:f.subtitleUrl,onChange:e=>P({...f,subtitleUrl:e.target.value}),className:"input-field",placeholder:"https://example.com/sub.vtt",disabled:s})]})}),(0,a.jsxs)("div",{className:"bg-slate-800 p-4 rounded border border-slate-700 mt-4",children:[(0,a.jsxs)("label",{className:"flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:f.shouldPublish,onChange:e=>P({...f,shouldPublish:e.target.checked}),className:"mr-2 rounded border-gray-600 bg-slate-800 text-green-500 focus:ring-green-500",disabled:s}),a.jsx("span",{className:"text-sm text-green-400 font-medium",children:"Publish Immediately"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-6",children:"If checked, the episode will be live immediately. Otherwise, it will be saved as Draft."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Primary Language ",a.jsx("span",{className:"text-red-400",children:"*"})]}),(0,a.jsxs)("select",{value:f.contentLanguagePrimary,onChange:e=>{let s=e.target.value;P({...f,contentLanguagePrimary:s,contentLanguagesAvailable:f.contentLanguagesAvailable.includes(s)?f.contentLanguagesAvailable:[...f.contentLanguagesAvailable,s]}),p("")},className:"input-field",required:!0,disabled:s,children:[a.jsx("option",{value:"en",children:"English"}),a.jsx("option",{value:"te",children:"Telugu"}),a.jsx("option",{value:"hi",children:"Hindi"}),a.jsx("option",{value:"es",children:"Spanish"}),a.jsx("option",{value:"fr",children:"French"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Available Languages"}),a.jsx("div",{className:"space-y-2 mt-2",children:["en","te","hi","es","fr"].map(e=>(0,a.jsxs)("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:f.contentLanguagesAvailable.includes(e),onChange:()=>U(e),disabled:s||e===f.contentLanguagePrimary,className:"mr-2 rounded border-gray-600 bg-slate-800 text-yellow-500 focus:ring-yellow-500 disabled:opacity-50"}),(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:["en"===e?"English":"te"===e?"Telugu":"hi"===e?"Hindi":"es"===e?"Spanish":"French",e===f.contentLanguagePrimary&&a.jsx("span",{className:"ml-2 text-xs text-yellow-500",children:"(Primary)"})]})]},e))})]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsxs)(i.default,{href:"/cms/lessons",className:"btn-secondary flex items-center gap-x-2",onClick:e=>s&&e.preventDefault(),children:[a.jsx(o.Z,{className:"h-4 w-4"}),"Cancel"]}),(0,a.jsxs)("button",{type:"submit",disabled:s||!f.termId,className:"btn-primary flex items-center gap-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(u.Z,{className:"h-4 w-4"}),s?"Creating...":"Create Episode"]})]})]}),a.jsx("div",{className:"card p-4 bg-yellow-900/20 border border-yellow-900/50",children:(0,a.jsxs)("p",{className:"text-sm text-yellow-400",children:[a.jsx("strong",{children:"Note:"})," The episode will be created as a ",a.jsx("strong",{children:"Draft"}),". After creating, you can add content URLs, thumbnails, and subtitles, then publish it."]})})]})})}},2811:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(3189).createProxy)(String.raw`C:\Users\yvish\projects\OTT platform\OTT_app-main\packages\cms\app\cms\lessons\new\page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[604,575,225],()=>t(1571));module.exports=a})();